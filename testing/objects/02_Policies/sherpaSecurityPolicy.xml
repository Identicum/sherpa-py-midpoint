<securityPolicy oid="00000000-0000-1de4-0012-000000000002"
                xmlns="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
                xmlns:c="http://midpoint.evolveum.com/xml/ns/public/common/common-3"
                xmlns:org="http://midpoint.evolveum.com/xml/ns/public/common/org-3">
	<name>Sherpa Security Policy</name>
	<credentials>
		<password>
			<minOccurs>0</minOccurs>
			<lockoutMaxFailedAttempts>3</lockoutMaxFailedAttempts>
			<lockoutFailedAttemptsDuration>PT5M</lockoutFailedAttemptsDuration>
			<lockoutDuration>PT60M</lockoutDuration>
			<valuePolicyRef xmlns:tns="http://midpoint.evolveum.com/xml/ns/public/common/common-3" oid="00000000-0000-0000-0000-000000000003" relation="org:default" type="tns:ValuePolicyType"></valuePolicyRef>
		</password>
	</credentials>
	<authentication>
		<modules>
			<loginForm>
				<name>loginForm</name>
			</loginForm>
			<httpBasic>
				<name>httpBasic</name>
			</httpBasic>
			<httpHeader>
				<name>httpHeader</name>
				<logoutUrl>/logout</logoutUrl>
				<usernameHeader>SM_USER</usernameHeader>
			</httpHeader>
		</modules>
		<sequence>
			<name>gui</name>
			<channel>
				<channelId>http://midpoint.evolveum.com/xml/ns/public/common/channels-3#user</channelId>
				<default>true</default>
				<urlSuffix>default</urlSuffix>
			</channel>
			<module>
				<name>httpHeader</name>
				<order>1</order>
				<necessity>sufficient</necessity>
			</module>
			<module>
				<name>loginForm</name>
				<order>2</order>
				<necessity>sufficient</necessity>
			</module>
		</sequence>
		<sequence>
			<name>rest</name>
			<channel>
				<channelId>http://midpoint.evolveum.com/xml/ns/public/common/channels-3#rest</channelId>
				<default>true</default>
				<urlSuffix>rest-default</urlSuffix>
			</channel>
			<module>
				<name>httpBasic</name>
				<order>10</order>
				<necessity>sufficient</necessity>
			</module>
		</sequence>
		<sequence>
			<name>actuator</name>
			<channel>
				<channelId>http://midpoint.evolveum.com/xml/ns/public/common/channels-3#actuator</channelId>
				<default>true</default>
				<urlSuffix>actuator-default</urlSuffix>
			</channel>
			<module>
				<name>httpBasic</name>
				<order>10</order>
				<necessity>sufficient</necessity>
			</module>
		</sequence>
		<ignoredLocalPath>/actuator</ignoredLocalPath>
		<ignoredLocalPath>/actuator/health</ignoredLocalPath>
	</authentication>
</securityPolicy>
